**Проект: Многоцелевая модель для NER + event-CLS**

**Цель:**

Создание объединённой (multi-task) модели, решающей **NER (BIO, token-level)** и **CLS (document-level multihot событий/отношений)** на датасете NEREL.

Активация виртуальной среды, установка зависимостей
Домашняя машина на windows:
.venv\Scripts\activate.bat 

Linux/Mac:
source .venv/bin/activate

pip install -r requirements.txt

Название ноутбука: NEREL_MultiTask_Notebook.ipynb

# Основные части ноутбука:

1. Подготовка окружения (пути, seed, imports)
2. EDA - загрузка jsonl, обзор, графики, выводы 
3. Парсинг и таргеты - здесь уже есть парсеры строкового формата NEREL; нужно реализовать сбор примеров (`build_examples_from_nerel`) 
4. Токенизация, выравнивание меток, DataLoader - реализовать `tokenize_and_align_labels`, Dataset/Collator 
5. Модель (JointModel) и кастомный loss (uncertainty-weighting) - реализовать модельный класс и loss
6. Тренировка/валидация - training loop, оптимизатор, scheduler, логирование метрик
7. Инференс и анализ ошибок - реализовать inference pipeline и примеры
8. Квантизация и сравнение - реализовать квантизацию и сравнить качество/скорость/размер модели

# Выводы:

- Многоцелевая модель может эффективно решать задачи NER и CLS одновременно.
- Квантизация модели до INT8 значительно уменьшает размер модели (в полтора раза) и ускоряет инференс (выигрыш около 20%) с минимальной потерей качества.
- Анализ ошибок показывает, что слабые места в классификации связаны с редкими классами и сложными контекстами, такими как классификация рядовых действий как события.
Также модель путается на вложенных сущностях. Улучшить это можно за счёт дополнительных данных или CRF.
- Итоговые метрики:
              Метрика  FP32_token  INT8_token  FP32_cls  INT8_cls
             F1_micro    0.850292    0.829357  0.818996  0.819713
             F1_macro    0.311002    0.264577  0.758431  0.759847
            Precision    0.850292    0.829357  0.818996  0.819713
               Recall    0.850292    0.829357  0.818996  0.819713
             Accuracy    0.850292    0.829357  0.818996  0.819713
    Время инференса   5.188541    3.981187  5.188541  3.981187

- Целевые показатели достигнуты: token-level F1 micro > 85%, cls-level F1 micro > 80%.


